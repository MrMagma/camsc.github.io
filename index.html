<!DOCTYPE html>
<html>
<head>
	<title>Common Core Math Standards</title>
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="map.css" rel="stylesheet">
	<link href="katex/katex.min.css" rel="stylesheet">
	<link href="font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body>

	<script src="jquery-1.11.1.min.js"></script>
	<script src="bootstrap/js/bootstrap.min.js"></script>
	<script src="katex/katex.min.js"></script>
	<script src="react/build/react.js"></script>
    <script src="react/build/JSXTransformer.js"></script>

	<script src="ccMappings.js"></script>
	<script src="ccMathStructure.js"></script>
	<script src="ccmath.js"></script>
	<script src="map.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58172126-1', 'auto');
  ga('send', 'pageview');

</script>

	<div class="modal fade" tabindex="-1" id="myModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h2 class="st-heading modal-title">
				<span class="st-code"></span>
			</h2>
	      </div>
	      <div class="modal-body">
	      	<div class="st-main"></div>
	      	<div class="st-example"></div>
	      	<!-- <h4>Exercises</h4>
			<ul class="ka-exercises"></ul> -->
			<p class="st-footnote"></p>
			<div class="st-thoughts"></div>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div><!-- /.modal -->

	<div id="heading">
		<h1>Common Core Math Standards</h1>
	</div>

	<div id="map-container"></div>
	<script type="text/jsx">
var MathStandards = React.createClass({
  render: function() {
    var structure = this.props.structure;
    return (
      <div>
        {structure.map(function(grade) {
          return <Grade key={grade.name} grade={grade} />;
        })}
      </div>
    );
  }
});

var Grade = React.createClass({
  render: function() {
    var grade = this.props.grade;
    return (
      <div className="grade-level">
      	<h2 className="grade-name" dangerouslySetInnerHTML={{__html: grade.name}} />
      	<div className="strand-container">
	      	{grade.strands.map(function(strand) {
	          return <Strand key={strand.name} strand={strand} />;
	        })}
        </div>
      </div>
    );
  }
});

var Strand = React.createClass({
  render: function() {
    var strand = this.props.strand;
    return (
      <div className={"strand " + strand.code}>
      	<h2 className="strand-name">{strand.name}&nbsp;{/*this allows for the "hidden strand" in grades 1 and 2*/}</h2>
      	{strand.clusters.map(function(cluster) {
          return <Cluster key={cluster.name} cluster={cluster} />;
        })}
      </div>
    );
  }
});

var Cluster = React.createClass({
  render: function() {
    var cluster = this.props.cluster;
    return (
      <div className="cluster">
      	<h3 className="cluster-name">{cluster.name}</h3>
      	{cluster.standards.map(function(standard) {
      	  if (standard.children) {
      	  	return (
      	  		<SubCluster key={standard.name} standard={standard} />
      	  		)
      	  } else {
      	  	return <Standard key={standard.name} standard={standard} />;
      	  }
        })}
      </div>
    );
  }
});

var SubCluster = React.createClass({
  render: function() {
    var standard = this.props.standard;
    var innerHtml = "" + mathItUp(standard.name) + "<span class='standard-code'>" + standard.code + "</span>";
    return (
      <div>
        <div 
        className="standard parent-standard"
        data-toggle="modal"
        data-target="#myModal"
        data-code={standard.code.replace(/\./, "-").replace(/\./, "-")}
        dangerouslySetInnerHTML={{__html: innerHtml}} />
        <div className="sub-cluster">
      	  {standard.children.map(function(child) {
      	    return <Standard key={child.name} standard={child} />;
          })}
        </div>
      </div>
    );
  }
});

var Standard = React.createClass({
  render: function() {
    var standard = this.props.standard;
    var innerHtml = "" + mathItUp(standard.name) + "<span class='standard-code'>" + standard.code + "</span>";
    return (
      <div 
        className="standard"
        data-toggle="modal"
        data-target="#myModal"
        data-code={standard.code.replace(/\./, "-").replace(/\./, "-")}
        dangerouslySetInnerHTML={{__html: innerHtml}} />
    );
  }
});

React.render(
  <MathStandards structure={ccMathStructure} />,
  document.getElementById('map-container'),
  function() {
  	var p = getParameterByName("s").replace(".", "-").replace(".", "-");
	if (p.length !== 0) {
		var standard = $( ".standard[data-code='" + p + "']" );
		$('html, body').animate({
	        scrollTop: standard.closest( ".grade-level" ).offset().top
	    }, 1000, function() {
			$( ".standard" ).each( function() {
				$(this).removeClass("standard-on");
			});
			standard.addClass("standard-on");
	    });
	    standard.trigger( "click" );
	}
  }
);
    </script>
</body>
</html>